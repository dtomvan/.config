module.exports = grammar({
  name: "kitty",

  rules: {
    source_file: ($) =>
      repeat(
        choice($.include, $.mapping, $.font_selection, $.command, $.comment)
      ),
    include: ($) => seq("include", $.include_file),
    command: ($) => seq($.identifier, repeat($.argument)),
    argument: ($) => choice($.color_code, $._argument),
    color_code: ($) => /#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/,
    comment: ($) => token(seq("#", /.*/)),
    include_file: ($) => /.+\.conf/,
    font_selection: ($) => seq($.font_command, $.font_name),
    font_command: ($) =>
      choice("font_family", "bold_font", "italic_font", "bold_italic_font"),
    font_name: ($) => /.+/,
    mapping: ($) => choice($.key_mapping, $.mouse_mapping),
    key_mapping: ($) => seq("map", $.key, $.map_command),
    mouse_mapping: ($) => seq("mouse_map", $.key, $.map_command),
    key: ($) => /\S+/,
    _argument: ($) => alias($.key, "_argument"),
    map_command: ($) => alias($.command, $.map_command),
    identifier: ($) =>
      choice(
        "action_alias",
        "active_border_color",
        "active_tab_background",
        "active_tab_font_style",
        "active_tab_foreground",
        "active_tab_title_template",
        "allow_cloning",
        "allow_hyperlinks",
        "allow_remote_control",
        "background",
        "background_image",
        "background_image_layout",
        "background_image_linear",
        "background_opacity",
        "background_tint",
        "background_tint_gaps",
        "bell_border_color",
        "bell_on_tab",
        "bell_path",
        "box_drawing_scale",
        "change_font_size",
        "clear_all_mouse_actions",
        "clear_all_shortcuts",
        "clear_selection",
        "clear_terminal",
        "click_interval",
        "clipboard_control",
        "clipboard_max_size",
        "clone_source_strategies",
        "close_on_child_death",
        "close_os_window",
        "close_other_tabs_in_os_window",
        "close_other_windows_in_tab",
        "close_shared_ssh_connections",
        "close_tab",
        "close_window",
        "close_window_with_confirmation",
        /color([0-9]+)/,
        "combine",
        "command_on_bell",
        "conda",
        "confirm",
        "confirm_os_window_close",
        "copy_and_clear_or_interrupt",
        "copy_ansi_to_clipboard",
        "copy_on_select",
        "copy_or_interrupt",
        "copy_to_buffer",
        "copy_to_clipboard",
        "create_marker",
        "cursor",
        "cursor_beam_thickness",
        "cursor_blink_interval",
        "cursor_shape",
        "cursor_stop_blinking_after",
        "cursor_text_color",
        "cursor_underline_thickness",
        "custom",
        "debug_config",
        "default_pointer_shape",
        "detach_tab",
        "detach_window",
        "detect_urls",
        "dim_opacity",
        "disable_ligatures",
        "disable_ligatures_in",
        "discard_event",
        "draw_minimal_borders",
        "dump_lines_with_attrs",
        "dynamic_background_opacity",
        "edit_config_file",
        "editor",
        "eighth_window",
        "enable_audio_bell",
        "enabled_layouts",
        "env",
        "env_var",
        "exe_search_path",
        "fade",
        "fifth_window",
        "file_transfer_confirmation_bypass",
        "filter",
        "first_window",
        "focus_follows_mouse",
        "focus_visible_window",
        "font_features",
        "font_size",
        "force_ltr",
        "foreground",
        "fourth_window",
        "goto_layout",
        "goto_tab",
        "hidden",
        "hide_macos_app",
        "hide_macos_other_apps",
        "hide_window_decorations",
        "inactive_border_color",
        "inactive_tab_background",
        "inactive_tab_font_style",
        "inactive_tab_foreground",
        "inactive_text_alpha",
        "index",
        "initial_window_height",
        "initial_window_width",
        "input_delay",
        "input_unicode_character",
        "kitten",
        "kitten_alias",
        "kitty_mod",
        "kitty_shell",
        "last_used_layout",
        "launch",
        "layout_action",
        "layout_name",
        "linux_display_server",
        "listen_on",
        "load_config_file",
        "macos_colorspace",
        "macos_custom_beam_cursor",
        "macos_hide_from_tasks",
        "macos_menubar_title_max_length",
        "macos_option_as_alt",
        "macos_quit_when_last_window_closed",
        "macos_show_window_title_in",
        "macos_thicken_font",
        "macos_titlebar_color",
        "macos_traditional_fullscreen",
        "macos_window_resizable",
        "mark1_background",
        "mark1_foreground",
        "mark2_background",
        "mark2_foreground",
        "mark3_background",
        "mark3_foreground",
        "max_title_length",
        "minimize_macos_window",
        "modify_font",
        "mouse_click_url",
        "mouse_click_url_or_select",
        "mouse_handle_click",
        "mouse_hide_wait",
        "mouse_select_command_output",
        "mouse_selection",
        "mouse_show_command_output",
        "move_tab_backward",
        "move_tab_forward",
        "move_window",
        "move_window_backward",
        "move_window_forward",
        "move_window_to_top",
        "narrow_symbols",
        "neighboring_window",
        "new_os_window",
        "new_os_window_with_cwd",
        "new_tab",
        "new_tab_with_cwd",
        "new_window",
        "new_window_with_cwd",
        "next_layout",
        "next_tab",
        "next_window",
        "ninth_window",
        "no",
        "no_op",
        "nth_os_window",
        "nth_window",
        "num_window_groups",
        "num_windows",
        "open_url",
        "open_url_with",
        "open_url_with_hints",
        "pass_selection_to_program",
        "password",
        "paste",
        "paste_actions",
        "paste_from_buffer",
        "paste_from_clipboard",
        "paste_from_selection",
        "paste_selection",
        "paste_selection_or_clipboard",
        "path",
        "placement_strategy",
        "pointer_shape_when_dragging",
        "pointer_shape_when_grabbed",
        "powerline",
        "previous_tab",
        "previous_window",
        "quit",
        "quote-urls-at-prompt",
        "remember_window_size",
        "remote_control",
        "remote_control_password",
        "remove_marker",
        "repaint_delay",
        "reset_window_sizes",
        "resize_debounce_time",
        "resize_draw_strategy",
        "resize_in_steps",
        "resize_window",
        "scrollback_fill_enlarged_window",
        "scrollback_lines",
        "scrollback_pager",
        "scrollback_pager_history_size",
        "scroll_end",
        "scroll_home",
        "scroll_line_down",
        "scroll_line_up",
        "scroll_page_down",
        "scroll_page_up",
        "scroll_prompt_to_bottom",
        "scroll_prompt_to_top",
        "scroll_to_mark",
        "scroll_to_prompt",
        "second_window",
        "select_by_word_characters",
        "select_by_word_characters_forward",
        "selection_background",
        "selection_foreground",
        "select_tab",
        "send_text",
        "separator",
        "set_background_opacity",
        "set_colors",
        "set_tab_title",
        "seventh_window",
        "shell",
        "shell_integration",
        "show_first_command_output_on_screen",
        "show_hyperlink_targets",
        "show_kitty_doc",
        "show_kitty_env_vars",
        "show_last_command_output",
        "show_last_non_empty_command_output",
        "show_last_visited_command_output",
        "show_scrollback",
        "signal_child",
        "single_window_margin_width",
        "sixth_window",
        "slant",
        "sleep",
        "socket",
        "socket-only",
        "start_resizing_window",
        "startup_session",
        "strip_trailing_spaces",
        "swap_with_window",
        "symbol_map",
        "sync_to_monitor",
        "tab.active_exe",
        "tab.active_wd",
        "tab_activity_symbol",
        "tab_bar_align",
        "tab_bar_background",
        "tab_bar_edge",
        "tab_bar_margin_color",
        "tab_bar_margin_height",
        "tab_bar_margin_width",
        "tab_bar_min_tabs",
        "tab_bar_style",
        "tab_fade",
        "tab_powerline_style",
        "tab_separator",
        "tab_switch_strategy",
        "tab_title_max_length",
        "tab_title_template",
        "tenth_window",
        "term",
        "third_window",
        "title",
        "toggle_fullscreen",
        "toggle_layout",
        "toggle_macos_secure_keyboard_entry",
        "toggle_marker",
        "toggle_maximized",
        "touch_scroll_multiplier",
        "undercurl_style",
        "update_check_interval",
        "url_color",
        "url_excluded_characters",
        "url_prefixes",
        "url_style",
        "venv",
        "visual_bell_color",
        "visual_bell_duration",
        "visual_window_select_characters",
        "watcher",
        "wayland_titlebar_color",
        "wheel_scroll_min_lines",
        "wheel_scroll_multiplier",
        "window_alert_on_bell",
        "window_border_width",
        "window_logo_alpha",
        "window_logo_path",
        "window_logo_position",
        "window_margin_width",
        "window_padding_width",
        "window_resize_step_cells",
        "window_resize_step_lines",
        "yes"
      ),
  },
});
